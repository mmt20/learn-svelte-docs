# Routing and Layouts

SvelteKit uses **file-system based routing**. The structure of your `src/routes/` directory directly maps to the URLs of your application. This document provides a comprehensive guide to pages, layouts, and all routing features.

---

## ğŸ“„ Pages & Layouts Overview

In SvelteKit, every route consists of two key file types:

| File | Purpose |
| :--- | :--- |
| `+page.svelte` | The page component (rendered content) |
| `+layout.svelte` | Wrapper component (shared UI like nav, footer) |

### How They Work Together

```
src/routes/
â”œâ”€â”€ +layout.svelte    â† Root layout (wraps ALL pages)
â”œâ”€â”€ +page.svelte      â† Home page (/)
â”œâ”€â”€ about/
â”‚   â””â”€â”€ +page.svelte  â† About page (/about)
â””â”€â”€ blog/
    â”œâ”€â”€ +layout.svelte â† Blog layout (wraps blog pages)
    â””â”€â”€ +page.svelte   â† Blog index (/blog)
```

When you visit `/blog`:
1. The **root layout** renders first
2. The **blog layout** renders inside it
3. The **blog page** renders inside the blog layout

> [!IMPORTANT]
> Layouts persist across navigation. When navigating between `/blog` and `/blog/post`, the blog layout doesn't re-renderâ€”only the page content changes.

---

## ğŸ”— Creating Routes & Navigating Between Routes

### Creating a Route

Simply create a folder with a `+page.svelte` file:

```
src/routes/
â”œâ”€â”€ +page.svelte          â†’ /
â”œâ”€â”€ about/
â”‚   â””â”€â”€ +page.svelte      â†’ /about
â”œâ”€â”€ contact/
â”‚   â””â”€â”€ +page.svelte      â†’ /contact
â””â”€â”€ services/
    â””â”€â”€ +page.svelte      â†’ /services
```

```svelte
<!-- src/routes/about/+page.svelte -->
<h1>About Us</h1>
<p>Learn more about our company.</p>
```

### Navigation with Links

Use standard `<a>` tagsâ€”SvelteKit intercepts them for client-side navigation:

```svelte
<!-- src/routes/+layout.svelte -->
<script>
  let { children } = $props();
</script>

<nav>
  <a href="/">Home</a>
  <a href="/about">About</a>
  <a href="/services">Services</a>
  <a href="/contact">Contact</a>
</nav>

<main>
  {@render children()}
</main>
```

### Programmatic Navigation

```svelte
<script>
  import { goto } from '$app/navigation';

  function navigateToDashboard() {
    goto('/dashboard');
  }

  function goBack() {
    history.back();
  }
</script>

<button onclick={navigateToDashboard}>Go to Dashboard</button>
<button onclick={goBack}>Go Back</button>
```

### Navigation Options

```javascript
import { goto } from '$app/navigation';

// Replace current history entry (can't go back)
goto('/login', { replaceState: true });

// Prevent scrolling to top
goto('/section', { noScroll: true });

// Invalidate all load functions
goto('/refresh', { invalidateAll: true });
```

---

## ğŸ”€ Dynamic Route Parameters

Dynamic routes use square brackets `[param]` to capture URL segments.

### Single Parameter

```
src/routes/
â””â”€â”€ blog/
    â””â”€â”€ [slug]/
        â””â”€â”€ +page.svelte  â†’ /blog/hello-world, /blog/my-first-post
```

```javascript
// src/routes/blog/[slug]/+page.js
export function load({ params }) {
  console.log(params.slug); // 'hello-world' or 'my-first-post'

  return {
    post: fetchPostBySlug(params.slug)
  };
}
```

```svelte
<!-- src/routes/blog/[slug]/+page.svelte -->
<script>
  let { data } = $props();
</script>

<article>
  <h1>{data.post.title}</h1>
  <p>{data.post.content}</p>
</article>
```

### Multiple Parameters

```
src/routes/
â””â”€â”€ products/
    â””â”€â”€ [category]/
        â””â”€â”€ [productId]/
            â””â”€â”€ +page.svelte  â†’ /products/electronics/iphone-15
```

```javascript
// +page.js
export function load({ params }) {
  const { category, productId } = params;
  // category = 'electronics'
  // productId = 'iphone-15'

  return {
    product: fetchProduct(category, productId)
  };
}
```

### Accessing Parameters in Components

```svelte
<script>
  import { page } from '$app/state';

  // Access current route parameters reactively
  $effect(() => {
    console.log('Current slug:', page.params.slug);
  });
</script>
```

---

## ğŸª† Nesting Pages & Layouts

Layouts can be nested to create hierarchical UI structures.

### Example: Dashboard with Nested Sections

```
src/routes/
â”œâ”€â”€ +layout.svelte              â† Root layout (site-wide nav)
â””â”€â”€ dashboard/
    â”œâ”€â”€ +layout.svelte          â† Dashboard layout (sidebar)
    â”œâ”€â”€ +page.svelte            â†’ /dashboard
    â”œâ”€â”€ analytics/
    â”‚   â””â”€â”€ +page.svelte        â†’ /dashboard/analytics
    â””â”€â”€ settings/
        â”œâ”€â”€ +layout.svelte      â† Settings layout (tabs)
        â”œâ”€â”€ +page.svelte        â†’ /dashboard/settings
        â”œâ”€â”€ profile/
        â”‚   â””â”€â”€ +page.svelte    â†’ /dashboard/settings/profile
        â””â”€â”€ security/
            â””â”€â”€ +page.svelte    â†’ /dashboard/settings/security
```

### Root Layout

```svelte
<!-- src/routes/+layout.svelte -->
<script>
  import SiteHeader from '$lib/components/SiteHeader.svelte';
  let { children } = $props();
</script>

<SiteHeader />
<div class="app-container">
  {@render children()}
</div>
```

### Dashboard Layout

```svelte
<!-- src/routes/dashboard/+layout.svelte -->
<script>
  import Sidebar from '$lib/components/Sidebar.svelte';
  let { children } = $props();
</script>

<div class="dashboard-layout">
  <Sidebar />
  <div class="dashboard-content">
    {@render children()}
  </div>
</div>

<style>
  .dashboard-layout {
    display: grid;
    grid-template-columns: 250px 1fr;
  }
</style>
```

### Settings Layout with Tabs

```svelte
<!-- src/routes/dashboard/settings/+layout.svelte -->
<script>
  import { page } from '$app/state';
  let { children } = $props();

  const tabs = [
    { href: '/dashboard/settings', label: 'General' },
    { href: '/dashboard/settings/profile', label: 'Profile' },
    { href: '/dashboard/settings/security', label: 'Security' }
  ];
</script>

<div class="settings-tabs">
  {#each tabs as tab}
    <a
      href={tab.href}
      class:active={page.url.pathname === tab.href}
    >
      {tab.label}
    </a>
  {/each}
</div>

<div class="settings-content">
  {@render children()}
</div>
```

---

## ğŸ›ï¸ Modifying Layouts Conditionally

Sometimes you need to change layout behavior based on the current route or user state.

### Conditional Rendering Based on Route

```svelte
<!-- src/routes/+layout.svelte -->
<script>
  import { page } from '$app/state';
  import Header from '$lib/components/Header.svelte';
  import Footer from '$lib/components/Footer.svelte';

  let { children } = $props();

  // Hide header/footer on auth pages
  const isAuthPage = $derived(
    page.url.pathname.startsWith('/login') ||
    page.url.pathname.startsWith('/register')
  );
</script>

{#if !isAuthPage}
  <Header />
{/if}

<main class:full-height={isAuthPage}>
  {@render children()}
</main>

{#if !isAuthPage}
  <Footer />
{/if}
```

### Using Layout Data for Conditional UI

```javascript
// src/routes/+layout.server.js
export async function load({ cookies }) {
  const session = cookies.get('session');
  const user = session ? await getUser(session) : null;

  return { user };
}
```

```svelte
<!-- src/routes/+layout.svelte -->
<script>
  import AuthNav from '$lib/components/AuthNav.svelte';
  import GuestNav from '$lib/components/GuestNav.svelte';

  let { data, children } = $props();
</script>

{#if data.user}
  <AuthNav user={data.user} />
{:else}
  <GuestNav />
{/if}

{@render children()}
```

---

## ğŸ“¦ Layout Groups

Route groups use parentheses `(groupName)` to organize routes **without affecting URLs**.

### Why Use Route Groups?

-   Apply different layouts to different sections
-   Organize related routes logically
-   Share layout data between specific routes only

### Example: Marketing vs App Sections

```
src/routes/
â”œâ”€â”€ (marketing)/
â”‚   â”œâ”€â”€ +layout.svelte        â† Marketing layout (hero, CTA buttons)
â”‚   â”œâ”€â”€ +page.svelte          â†’ / (home page)
â”‚   â”œâ”€â”€ about/
â”‚   â”‚   â””â”€â”€ +page.svelte      â†’ /about
â”‚   â”œâ”€â”€ pricing/
â”‚   â”‚   â””â”€â”€ +page.svelte      â†’ /pricing
â”‚   â””â”€â”€ contact/
â”‚       â””â”€â”€ +page.svelte      â†’ /contact
â””â”€â”€ (app)/
    â”œâ”€â”€ +layout.svelte        â† App layout (dashboard sidebar)
    â”œâ”€â”€ dashboard/
    â”‚   â””â”€â”€ +page.svelte      â†’ /dashboard
    â””â”€â”€ profile/
        â””â”€â”€ +page.svelte      â†’ /profile
```

### Marketing Layout

```svelte
<!-- src/routes/(marketing)/+layout.svelte -->
<script>
  import MarketingHeader from '$lib/components/MarketingHeader.svelte';
  import MarketingFooter from '$lib/components/MarketingFooter.svelte';
  let { children } = $props();
</script>

<MarketingHeader />
<main class="marketing-content">
  {@render children()}
</main>
<MarketingFooter />
```

### App Layout

```svelte
<!-- src/routes/(app)/+layout.svelte -->
<script>
  import AppSidebar from '$lib/components/AppSidebar.svelte';
  import AppHeader from '$lib/components/AppHeader.svelte';
  let { children } = $props();
</script>

<div class="app-shell">
  <AppSidebar />
  <div class="app-main">
    <AppHeader />
    {@render children()}
  </div>
</div>
```

> [!TIP]
> The parentheses `()` are stripped from the URL. `/about` works, not `/(marketing)/about`.

---

## ğŸš€ Breaking Out of Layouts Hierarchy

Use `@` syntax to escape from parent layouts.

### The Problem

Sometimes a page needs a completely different layout than its parents provide. For example, a fullscreen modal or a print-friendly page.

### Breaking to Root Layout

```
src/routes/
â”œâ”€â”€ +layout.svelte              â† Root layout
â””â”€â”€ dashboard/
    â”œâ”€â”€ +layout.svelte          â† Dashboard layout (sidebar)
    â”œâ”€â”€ +page.svelte            â†’ /dashboard (uses both layouts)
    â””â”€â”€ fullscreen/
        â””â”€â”€ +page@.svelte       â†’ /dashboard/fullscreen (ONLY root layout!)
```

The `@.` means "reset to the root layout, ignoring all intermediate layouts."

### Breaking to a Specific Layout

```
src/routes/
â”œâ”€â”€ +layout.svelte              â† (root)
â””â”€â”€ admin/
    â”œâ”€â”€ +layout.svelte          â† (admin)
    â””â”€â”€ reports/
        â”œâ”€â”€ +layout.svelte      â† (reports)
        â”œâ”€â”€ +page.svelte        â†’ Uses root + admin + reports
        â””â”€â”€ print/
            â””â”€â”€ +page@admin.svelte  â†’ Uses root + admin ONLY
```

### Syntax Reference

| Filename | Uses These Layouts |
| :--- | :--- |
| `+page.svelte` | All ancestor layouts |
| `+page@.svelte` | Only root layout |
| `+page@admin.svelte` | Layouts up to and including `admin` |
| `+layout@.svelte` | The layout itself resets to root |

### Example: Print-Friendly Page

```svelte
<!-- src/routes/invoices/[id]/print/+page@.svelte -->
<script>
  let { data } = $props();
</script>

<!-- No sidebar, no headerâ€”just the invoice -->
<div class="print-invoice">
  <h1>Invoice #{data.invoice.number}</h1>
  <!-- Invoice content -->
</div>

<style>
  @media print {
    .print-invoice { margin: 0; }
  }
</style>
```

---

## ğŸ”š Rest Parameters

Capture **multiple path segments** with `[...param]`.

### Use Cases

-   Documentation sites with nested paths (`/docs/api/auth/oauth`)
-   File browsers (`/files/documents/2024/january`)
-   Catch-all routes

### Example: Documentation Site

```
src/routes/
â””â”€â”€ docs/
    â””â”€â”€ [...slug]/
        â””â”€â”€ +page.svelte  â†’ /docs, /docs/intro, /docs/api/users
```

```javascript
// src/routes/docs/[...slug]/+page.js
export function load({ params }) {
  // params.slug is undefined for /docs
  // params.slug = 'intro' for /docs/intro
  // params.slug = 'api/users' for /docs/api/users

  const segments = params.slug ? params.slug.split('/') : [];

  return {
    segments,
    content: fetchDocContent(params.slug || 'index')
  };
}
```

```svelte
<!-- src/routes/docs/[...slug]/+page.svelte -->
<script>
  let { data } = $props();
</script>

<nav class="breadcrumbs">
  <a href="/docs">Docs</a>
  {#each data.segments as segment, i}
    <span>/</span>
    <a href="/docs/{data.segments.slice(0, i + 1).join('/')}">{segment}</a>
  {/each}
</nav>

<article>
  {@html data.content}
</article>
```

### Matching the Base Route

Rest parameters match **zero or more** segments:

| URL | `params.slug` |
| :--- | :--- |
| `/docs` | `undefined` |
| `/docs/intro` | `'intro'` |
| `/docs/api/users` | `'api/users'` |

---

## â“ Optional Parameters

Make route segments **optional** with double brackets `[[param]]`.

### Use Cases

-   Internationalization (`/about` and `/en/about`)
-   Optional filters (`/products` and `/products/category`)

### Example: Language Prefix

```
src/routes/
â””â”€â”€ [[lang]]/
    â”œâ”€â”€ +layout.svelte
    â”œâ”€â”€ +page.svelte      â†’ /, /en, /fr, /de
    â””â”€â”€ about/
        â””â”€â”€ +page.svelte  â†’ /about, /en/about, /fr/about
```

```javascript
// src/routes/[[lang]]/+layout.js
const SUPPORTED_LANGS = ['en', 'fr', 'de', 'es'];

export function load({ params }) {
  const lang = params.lang && SUPPORTED_LANGS.includes(params.lang)
    ? params.lang
    : 'en'; // Default to English

  return { lang };
}
```

```svelte
<!-- src/routes/[[lang]]/+layout.svelte -->
<script>
  let { data, children } = $props();
</script>

<html lang={data.lang}>
  <!-- ... -->
  {@render children()}
</html>
```

### Combining with Other Parameters

```
src/routes/
â””â”€â”€ [[lang]]/
    â””â”€â”€ products/
        â””â”€â”€ [category]/
            â””â”€â”€ +page.svelte  â†’ /products/shoes, /en/products/shoes
```

---

## âœ… Parameter Matchers

Validate and constrain dynamic parameters using **matchers**.

### Creating a Matcher

```javascript
// src/params/integer.js
export function match(param) {
  return /^\d+$/.test(param);
}
```

### Using a Matcher

```
src/routes/
â””â”€â”€ posts/
    â””â”€â”€ [id=integer]/
        â””â”€â”€ +page.svelte  â†’ /posts/123 âœ“, /posts/abc âœ—
```

The `[id=integer]` syntax means:
-   The parameter is named `id`
-   It must pass the `integer` matcher
-   If it fails, SvelteKit continues to the next matching route (or 404)

### Common Matchers

```javascript
// src/params/slug.js
export function match(param) {
  return /^[a-z0-9-]+$/.test(param);
}

// src/params/uuid.js
export function match(param) {
  return /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(param);
}

// src/params/date.js
export function match(param) {
  return /^\d{4}-\d{2}-\d{2}$/.test(param) && !isNaN(Date.parse(param));
}
```

### Multiple Parameters with Matchers

```
src/routes/
â””â”€â”€ events/
    â””â”€â”€ [year=integer]/
        â””â”€â”€ [month=integer]/
            â””â”€â”€ +page.svelte  â†’ /events/2024/01
```

---

## ğŸ§¹ Finalizing & Cleaning Up Routes

### Best Practices for Route Organization

#### 1. Group Related Routes

```
src/routes/
â”œâ”€â”€ (marketing)/           â† Public pages
â”‚   â”œâ”€â”€ +page.svelte
â”‚   â”œâ”€â”€ about/
â”‚   â””â”€â”€ pricing/
â”œâ”€â”€ (app)/                 â† Authenticated app
â”‚   â”œâ”€â”€ dashboard/
â”‚   â””â”€â”€ settings/
â””â”€â”€ (auth)/                â† Auth flows
    â”œâ”€â”€ login/
    â”œâ”€â”€ register/
    â””â”€â”€ forgot-password/
```

#### 2. Use Consistent Naming

-   Lowercase folder names
-   Hyphens for multi-word routes (`forgot-password`, not `forgotPassword`)
-   Singular for resource items (`/user/[id]`), plural for collections (`/users`)

#### 3. Colocate Related Files

```
src/routes/
â””â”€â”€ blog/
    â””â”€â”€ [slug]/
        â”œâ”€â”€ +page.svelte      â† The page
        â”œâ”€â”€ +page.js          â† Universal load
        â”œâ”€â”€ +page.server.js   â† Server load (if needed)
        â””â”€â”€ BlogPost.svelte   â† Component (colocation)
```

#### 4. Create Shared Components in `$lib`

```
src/
â”œâ”€â”€ lib/
â”‚   â””â”€â”€ components/
â”‚       â”œâ”€â”€ Header.svelte
â”‚       â”œâ”€â”€ Footer.svelte
â”‚       â””â”€â”€ Sidebar.svelte
â””â”€â”€ routes/
    â””â”€â”€ +layout.svelte  â† Imports from $lib
```

---

## ğŸ“Š Summary

| Feature | Syntax | Example |
| :--- | :--- | :--- |
| Static route | `routes/about/+page.svelte` | `/about` |
| Dynamic param | `routes/blog/[slug]/+page.svelte` | `/blog/hello` |
| Multiple params | `routes/[cat]/[id]/+page.svelte` | `/books/123` |
| Rest params | `routes/docs/[...path]/+page.svelte` | `/docs/a/b/c` |
| Optional params | `routes/[[lang]]/about/+page.svelte` | `/about`, `/en/about` |
| Param matcher | `routes/posts/[id=integer]/+page.svelte` | `/posts/42` |
| Layout | `routes/+layout.svelte` | Wraps children |
| Nested layout | `routes/dashboard/+layout.svelte` | Nested wrapper |
| Route group | `routes/(marketing)/+page.svelte` | `/` (group hidden) |
| Break layout | `routes/admin/+page@.svelte` | Uses root only |

---

