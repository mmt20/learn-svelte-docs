# Props and Event Handling

In Svelte 5, component communication is handled through the `$props()` rune and standard DOM event attributes.

## 1. Component Props with `$props()`

Props are how data flows from a parent component to a child component.

### Basic Usage
Use the `$props()` rune to declare the props your component accepts.

**Child.svelte**
```html
<script>
  let { name, age = 18 } = $props();
</script>

<p>User: {name}, Age: {age}</p>
```

**App.svelte**
```html
<Child name="Alice" age={25} />
<Child name="Bob" /> <!-- age defaults to 18 -->
```

### TypeScript and Props
In Svelte 5, you can easily type your props using an interface.

```html
<script lang="ts">
  interface UserProps {
    name: string;
    isAdmin?: boolean;
    children: import('svelte').Snippet;
  }

  let { name, isAdmin = false, children }: UserProps = $props();
</script>

<div class:admin={isAdmin}>
  <h1>{name}</h1>
  {@render children()}
</div>
```

---

## 2. Event Handling

Svelte 5 moves away from `on:click` syntax in favor of standard HTML attributes like `onclick`.

### DOM Events
You can attach event listeners directly to elements.

```html
<script>
  let count = $state(0);

  function handleClick(event) {
    count += 1;
    console.log('Button clicked!', event);
  }
</script>

<button onclick={handleClick}>
  Count: {count}
</button>

<!-- Inline handler -->
<button onclick={() => count = 0}>
  Reset
</button>
```

### Event Modifiers
Since Svelte 5 uses standard attributes, you handle modifiers like `preventDefault` manually in JavaScript.

```html
<script>
  function handleSubmit(e) {
    e.preventDefault();
    console.log('Form submitted without reloading');
  }
</script>

<form onsubmit={handleSubmit}>
  <button type="submit">Send</button>
</form>
```

---

## 3. Custom Events (Callback Props)

In Svelte 5, the recommended way to communicate from a child to a parent is by passing a callback function as a prop. This replaces the old `createEventDispatcher`.

**Child.svelte**
```html
<script>
  let { onnotify } = $props();
</script>

<button onclick={() => onnotify('Hello from Child!')}>
  Notify Parent
</button>
```

**App.svelte**
```html
<script>
  function handleNotification(message) {
    alert(message);
  }
</script>

<Child onnotify={handleNotification} />
```

> [!TIP]
> This pattern is more powerful because it's fully typed and works exactly like standard JavaScript event handling.

## 4. Advanced Event Concepts: Bubbling, Capture, and Delegation

Since Svelte 5 uses standard DOM events, understanding how events move through the DOM is crucial.

### Event Bubbling (Default)
When an event happens on an element, it first runs the handlers on it, then on its parent, then all the way up on other ancestors.

```html
<div onclick={() => alert('Div clicked!')}>
  <button onclick={() => alert('Button clicked!')}>
    Click Me (Bubbles up)
  </button>
</div>
```

To stop bubbling, use `event.stopPropagation()`:
```html
<button onclick={(e) => {
  e.stopPropagation();
  alert('Only button alerts!');
}}>No Bubble</button>
```

### Event Capture
Capturing is the opposite of bubblingâ€”the event goes from the top down. In Svelte 5, you can use capturing by appending `capture` to the event name (if supported by your toolchain) or by manually adding a listener, but the standard way is to use the standard DOM API if needed. 

> [!NOTE]
> Most UI logic relies on bubbling. Capture is rare but useful for "intercepting" events before they reach children.

### Event Delegation
Instead of adding a listener to 100 buttons, you add ONE listener to their parent. This is better for performance and memory.

```html
<script>
  function handleListClick(event) {
    // Check if what was clicked is actually a button
    const target = event.target;
    if (target.tagName === 'BUTTON') {
      console.log('Clicked item:', target.textContent);
    }
  }
</script>

<ul onclick={handleListClick}>
  <li><button>Item 1</button></li>
  <li><button>Item 2</button></li>
  <li><button>Item 3</button></li>
</ul>
```

## 5. Summary

| Feature | Svelte 4 (Old) | Svelte 5 (New) |
| :--- | :--- | :--- |
| **Declaring Props** | `export let name;` | `let { name } = $props();` |
| **DOM Events** | `on:click={fn}` | `onclick={fn}` |
| **Custom Events** | `dispatch('name', data)` | `onname(data)` (callback prop) |
| **Modifiers** | `on:click|preventDefault` | `e.preventDefault()` in function |
